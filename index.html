<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Giphy Project</title>

  <link rel="stylesheet" type="text/css" href="assets/style.css">
</head>

<body>

<div class="container">
    <h1>'The Office' Themed Gif Search!</h1>
    <h3>Name a character or theme to add:</h3>
    
    <div id="buttons-view"></div>
    
    <form id="gif-form">
        <label for="gif-input">Add your own themed GIF!</label><br>
        <input type="text" id="gif-input"><br>
    
        <input id="add-gif" type="submit" value="Add your own Gif!">
    </form>
    
    <div id="gifs-view"></div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript">
    // Initial array of movies
    var characters = ["Michael Scott", "Dwight Schrute", "Jim Halpert", "Andy Bernard"];
    
    //--------------------------------------------

    // displayMovieInfo function re-renders the HTML to display the appropriate content
    function displayGifInfo() {
    
        var newGif = $(this).attr("data-name");
        var queryURL = "https://api.giphy.com/v1/gifs/search?api_key=QTPKnPYLRn2pBQUK1wl3AezC8f3K8fmj&q=theoffice&limit=25&offset=0&rating=G&lang=en";
    
        $.ajax({
            url: queryURL,
            method: "GET"
        }).then(function(response) {
            console.log(response);

            var gifDiv = $("<div class='gif'>");
    
            //--------------------------------------------

            // Storing the rating data
            var rating = response.Rated;
    
            // Creating an element to have the rating displayed
            var rated = $("<p>").text("Rating: " + rating);
    
            // Displaying the rating
            gifDiv.append(rating);
    
            // Storing the plot
            var plot = response.Plot;
    
            // Creating an element to hold the plot
            var pThree = $("<p>").text("Plot: " + plot);
    
            // Appending the plot
            gifDiv.append(pThree);

            //--------------------------------------------
    
            // Retrieving the URL for the image
            var imgURL = response.Poster;
    
            // Creating an element to hold the image
            var image = $("<img>").attr("src", imgURL);
    
            // Appending the image
            gifDiv.append(image);

            //--------------------------------------------
    
            // Putting the entire movie above the previous movies
            $("#gifs-view").prepend(gifDiv);
        });
    }
    
        // Function for displaying movie data
        function renderButtons() {
    
        // Deleting the movies prior to adding new movies
        // (this is necessary otherwise you will have repeat buttons)
        $("#buttons-view").empty();
    
        // Looping through the array of movies
        for (var i = 0; i < characters.length; i++) {
    
            // Then dynamicaly generating buttons for each movie in the array
            // This code $("<button>") is all jQuery needs to create the beginning and end tag. (<button></button>)
            var a = $("<button>");
            // Adding a class of movie-btn to our button
            a.addClass("gif-btn");
            // Adding a data-attribute
            a.attr("data-name", characters[i]);
            // Providing the initial button text
            a.text(characters[i]);
            // Adding the button to the buttons-view div
            $("#buttons-view").append(a);
        }
    }

    //--------------------------------------------
    
        $("#add-gif").on("click", function(event) {
        event.preventDefault();

            var newGif = $("#gif-input").val();
    
            characters.push(newGif);

            renderButtons();
        });

        $(document).on("click", ".gif-btn", displayGifInfo);
    
        renderButtons();

</script>
</div>

</body>
</html>